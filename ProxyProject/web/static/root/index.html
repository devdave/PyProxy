<!DOCTYPE html>
<html>
    <head>
        <title>PyProxy Control</title>
        <link type="text/css" href="/css/ui-lightness/jquery-ui-1.8.14.custom.css" rel="Stylesheet" />	
    </head>    
    <body>
        <h2>Host lists</h2>
        <div id="menu">
            <p>Pending ajax call</p>
        </div>
        <label>Poll?</label>
        <input type="checkbox" checked="checked" id="polling"/>
        
        <script src="/js/jquery.js" /></script>
        <script src="/js/jquery-ui-dev-.js" /></script>
        <script src="/js/tmpl.js" /></script>
        <script src="/js/app.js" /></script>
        <script>
        var ts = 0;
        var delay = 1500;
        var reloader = function(){
            
                $("#menu").load("/hosts/list", { "ts" : ts }, function(){
                    if($("#polling").val() != "on"){
                        reloader.running = false;
                        return;
                    }else{
                        this.running = true;
                        setTimeout(reloader, delay);
                    }
                });
                            
                
            };
            
            
        $(function(){
            
            $("#polling").change(function(){
                if(this.checked == true){
                    setTimeout(reloader, delay);
                }
            });
            reloader()
            
        })
            
        </script>
    </body>
</html>